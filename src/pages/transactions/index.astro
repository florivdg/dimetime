---
import Layout from '@/layouts/Layout.astro'
import Dashboard from '@/components/Dashboard.vue'
import TransactionManager from '@/components/transactions/TransactionManager.vue'
import { getTransactions } from '@/lib/transactions'
import { getAllCategories } from '@/lib/categories'

// Load initial data server-side
const { transactions, pagination } = await getTransactions({
  sortBy: 'dueDate',
  sortDir: 'desc',
  page: 1,
  limit: 20,
})
const categories = await getAllCategories()
---

<Layout>
  <Dashboard
    client:load
    currentPath={Astro.url.pathname}
    breadcrumbs={[{ label: 'Transaktionen' }]}
  >
    <div class="flex flex-1 flex-col gap-4">
      <div class="flex items-center justify-between">
        <h1 class="text-2xl font-semibold tracking-tight">Transaktionen</h1>
      </div>
      <TransactionManager
        client:load
        initialTransactions={transactions}
        initialPagination={pagination}
        categories={categories}
      />
    </div>
  </Dashboard>
</Layout>
